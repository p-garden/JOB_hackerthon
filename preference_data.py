import pandas as pd

# 1. 파일 로드
jd = pd.read_csv("data/resume_DB.csv")
jd = jd[["기업명", "직무명"]].dropna().drop_duplicates()
company = pd.read_csv("data/company_info.csv")

# 2. 전처리
company = company[["회사명", "신입사원 초봉", "인재상"]].rename(columns={
    "회사명": "기업명", "신입사원 초봉": "salary_raw", "인재상": "vision"
})
jd["기업명"] = jd["기업명"].str.strip()
company["기업명"] = company["기업명"].str.strip()

# 3. 연봉 정제 함수
def parse_salary(s):
    if isinstance(s, str) and "만원" in s:
        return int(s.replace(",", "").replace("만원", ""))
    return None
company["salary"] = company["salary_raw"].apply(parse_salary)

# 4. 병합
merged = pd.merge(jd, company, on="기업명", how="left")

# 5. 기업 성향 점수 / 조직 규모 매핑
trait_map = {
    "국민건강보험공단": 1.0, "국민연금공단": 1.0, "국민은행": 1.0, "우리은행": 1.0,
    "중소기업은행": 1.0, "한국가스공사": 1.0, "한국산업은행": 1.0, "한국수출입은행": 1.0,
    "한국전력공사": 1.0, "한국토지주택공사": 1.0,

    "CJ제일제당": 0.7, "GS": 0.7, "LG전자": 0.7, "롯데쇼핑": 0.7, "케이티": 0.7,
    "한화": 0.7, "GS칼텍스": 0.7, "에이치엠엠": 0.7, "삼성SDI": 0.7,

    "SK텔레콤": 0.5, "LG화학": 0.5, "대한항공": 0.5, "현대건설": 0.5,
    "포스코홀딩스": 0.5, "삼성생명보험": 0.5, "에이치디현대": 0.5, "엘지이노텍": 0.5,
    "포스코인터내셔널": 0.5, "LX인터내셔널": 0.5, "LG디스플레이": 0.5,

    "현대글로비스": 0.3, "현대제철": 0.3, "롯데케미칼": 0.3, "지에스건설": 0.3,
    "미래에셋증권": 0.3, "SK": 0.3, "지에스리테일": 0.3, "LS": 0.3,

    "삼성전자": 0.0, "SK하이닉스": 0.0, "쿠팡": 0.0, "현대자동차": 0.0,
    "기아": 0.0, "현대모비스": 0.0, "LG에너지솔루션": 0.0
}
scale_map = {
    # 대기업
    "국민은행": 1.0, "우리은행": 1.0, "삼성전자": 1.0, "SK하이닉스": 1.0, "LG전자": 1.0,
    "LG화학": 1.0, "SK텔레콤": 1.0, "삼성생명보험": 1.0, "삼성SDI": 1.0, "S-Oil": 1.0,
    "대한항공": 1.0, "기아": 1.0, "현대자동차": 1.0, "현대모비스": 1.0, "포스코홀딩스": 1.0,
    "에이치엠엠": 1.0, "현대건설": 1.0, "GS": 1.0, "GS칼텍스": 1.0, "한화": 1.0, "케이티": 1.0,

    # 중견·공기업
    "국민건강보험공단": 0.7, "국민연금공단": 0.7, "한국전력공사": 0.7, "한국가스공사": 0.7,
    "한국토지주택공사": 0.7, "한국산업은행": 0.7, "한국수출입은행": 0.7, "중소기업은행": 0.7,
    "CJ제일제당": 0.7, "씨제이대한통운": 0.7, "미래에셋증권": 0.7, "엘지이노텍": 0.7,
    "LX인터내셔널": 0.7, "LG디스플레이": 0.7, "현대글로비스": 0.7, "현대제철": 0.7,
    "지에스건설": 0.7, "포스코인터내셔널": 0.7, "에이치디현대": 0.7, "다우기술": 0.7,
    "지에스리테일": 0.7, "LS": 0.7,

    # 스타트업
    "쿠팡": 0.5
}

merged["traits"] = merged["기업명"].map(trait_map).fillna(0.5)
merged["scale"] = merged["기업명"].map(scale_map).fillna(0.7)

# 6. 필드 정리 & 저장
final = merged[["기업명", "직무명", "salary", "vision", "traits", "scale"]]
final = final.dropna(subset=["salary", "vision"])
final.to_json("data/company_preference.json", orient="records", indent=2, force_ascii=False)

"""CJ제일제당
GS
GS칼텍스
KB손해보험
LS
LX인터내셔널
LG디스플레이
LG에너지솔루션
LG전자
LG화학
S-Oil
SK
SK하이닉스
SK텔레콤
강원랜드
국민건강보험공단
국민연금공단
국민은행
기아
다우기술
대한항공
미래에셋증권
삼성SDI
삼성생명보험
삼성전자
씨제이대한통운
에이치디현대
에이치엠엠
엘지이노텍
우리은행
지에스건설
지에스리테일
쿠팡
케이티
포스코인터내셔널
포스코홀딩스
하나은행
한화
현대건설
현대글로비스
현대모비스
현대자동차
현대제철
한국가스공사
한국산업은행
한국수출입은행
한국전력공사
한국토지주택공사
중소기업은행

['개발', '금융/재무', '기획/경영', '데이터', '디자인',
 '마케팅/시장조사', '생산/제조', '생산관리/품질관리',
 '서비스/고객지원', '엔지니어링', '연구개발', '영업/제휴',
 '유통/무역', '인사/총무', '전문직']
"""